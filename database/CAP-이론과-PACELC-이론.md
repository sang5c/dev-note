### CAP 이론

분산 데이터베이스 시스템에서의 중요 특성과 한계를 설명하는 이론. 네트워크로 분산된 데이터베이스 시스템은 CAP 중 두 가지 특성만 충족 가능하다. 기술적 선택을 내리는 지표로 사용한다.

- Consistency (일관성)
    - 데이터가 일관적으로 반환된다. 클라이언트가 어떤 노드와 통신했는지와 상관 없이 항상 같은 데이터를 반환해야 한다. 만족하려면 모든 노드에서 같은 데이터를 들고 있어야 한다.
        - A, B, C 노드가 있을 때, 데이터가 A에서 업데이트되면 B와 C도 동일한 데이터를 가지고 있어야 한다
    - 이를 만족하기 위해선 특정 노드에 쓰기가 수행되면 모든 노드에 동기화 작업이 필요하다.
        - A에게 알려준걸 B, C에게 전파
- Availability (가용성)
    - 읽기/쓰기 요청이 항상 성공해야 한다. 하나의 노드가 망가져도(장애) 다른 노드에서 서비스를 제공해야 한다는 의미이다.
        - A가 망가지면 B 또는 C가 대신 응답한다
    - 장애 이후 복구된 노드가 다른 노드와 데이터 동기화가 이루어지지 않았다면 일관성이 떨어진다.
- Partition Tolerance (분할 허용성)
    - 파티션(노드간 통신 단절)이 생겨도 시스템이 작동을 멈추지 않아야 한다
    - A ↔ B가 서로 연결이 끊겨도 클라이언트 → A, 클라이언트 → B 각각이 응답 가능해야 한다. 단, 연결이 끊어지면 동기화를 수행할 수 없기에 A가 알고있는 정보와 B가 알고있는 정보가 다를 수 있다.
      이를 허용하는 것을 분할 허용성이라 한다.
- 네트워크 장애에서 자유로운 분산 시스템은 없다. 따라서 분할 허용성은 필연적이다. 또한 일관성과 가용성은 동시 만족이 어렵다. → CAP중 선택지는 CP 또는 AP가 된다.
    - 일관성을 우선시하면 모든 노드의 동기화가 필요하다. 네트워크 장애시 동기화가 불가능하기에 가용성이 떨어지게 된다.
    - 네트워크 장애시 가용성을 우선시하면 데이터 동기화가 이루어지지 않았기에 일관성이 떨어진다.
- CAP를 확장한 개념으로 분할 발생에 따른 선택을 정리한 PACELC 이론이 있다.
    - 네트워크 파티션(P) 상황에서 가용성(A)와 일관성(C) 둘 중 하나를 선택해야 하며, 그렇지 않은 경우(Else) 파티션이 없는 상태에서 시스템이 정상적으로 실행되는 경우 시간(Latency)과 일관성(
      C) 중에 하나를 선택해야 한다.

### PACELC 이론

- 분산 환경에서 네트워크 파티션(P)이 발생했을 때 가용성(A)과 일관성(C)중 하나를 선택해야 하고, 아니라면(E) 지연 시간(L)과 일관성(C)중에 선택해야 한다는 이론.
    - P일때 A와 C는 동시에 100% 만족할 수 없다. 하나를 선택해야 한다.
    - E일땐 L과 C를 동시에 100% 만족할 수 없다. 동기화를 통한 일관성(C) 제공을 먼저할건지, 빠르게 응답할 것인지(L) 선택해야 한다
- CAP 이론의 확장이다. 분산 환경에서 파티션 발생은 불가피하고, 각 상황별 트레이드 오프를 선택해야 한다는 이론이다. PAC와 ELC를 나눠서 보면 된다.
- 네트워크 파티션(P) 발생 시 가용성(A)을 선택하고, 발생하지 않았을 시(E) 낮은 시간 지연(L)을 선택한 시스템은 PA/EL 로 분류한다.
    - PA → 네트워크 파티션 상황에서 가용성(A) 선택. 일관성(C)을 지키려면 모든 노드간 데이터가 동일해야 한다. 노드간 데이터가 동기화되지 않아도 응답하기에 동일 요청에 대해 다른 응답을 제공할 수
      있다.
    - EL → 네트워크 정상 상황에서 빠른 응답 시간(L)을 우선적으로 선택.
